<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <h1>hello SELFIE app</h1>
    <p>
        Latitude:<span id="lat">&deg;</span>
    </p>
    <p>
        Longitude:<span id="lon">&deg;</span>
    </p>
    <h2>SURVEY</h2>
    <p>
        <label for="vege">Enter your favourite vegetable:</label>
        <input id="vege" type="text" placeholder="your vege">
    </p>
    <button id="getDirData">Submit</button>

    <script>
        const button = document.getElementById("getDirData")
        let lat, lon;
        button.addEventListener("click", async (event) => {
            const vege = document.getElementById("vege").value
            const data = { lat, lon, vege };
            const options = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            };
            const response = await fetch("/api", options);
            const json = await response.json();
            console.log(json);
        });

        if ('geolocation' in navigator) {
            console.log('geolocation is available')
            navigator.geolocation.getCurrentPosition(async position => {
                lat = position.coords.latitude
                lon = position.coords.longitude

                document.getElementById('lat').textContent = lat
                document.getElementById('lon').textContent = lon

                // console.log( lat, lon )

            });

        } else {
            console.log('geolocation is NOT available')
        }


    </script>

</body>

</html>